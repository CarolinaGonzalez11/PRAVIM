{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f6f8;
    }
    .form-container {
        max-width: 960px;
        margin: 0 auto;
        background-color: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .logo {
        display: block;
        margin: 0 auto 20px;
        background-color: #252c54;
        padding: 10px;
        border-radius: 6px;
        text-align: center;
    }
    .logo img {
        height: 60px;
    }
    .step-indicator {
        display: flex;
        justify-content: space-between;
        margin-bottom: 25px;
        counter-reset: step;
    }
    .step {
        text-align: center;
        position: relative;
        flex: 1;
    }
    .step::before {
        counter-increment: step;
        content: counter(step);
        width: 30px;
        height: 30px;
        background-color: #252c54;
        color: white;
        border-radius: 50%;
        display: inline-block;
        line-height: 30px;
        margin-bottom: 5px;
    }
    .step::after {
        content: attr(data-label);
        display: block;
        font-size: 12px;
        color: #444;
    }
    form input, form select, form textarea {
        width: 100%;
        padding: 8px;
        margin: 5px 0 15px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
    .form-section h3 {
        color: #252c54;
        border-bottom: 2px solid #252c54;
        padding-bottom: 5px;
        margin-top: 25px;
    }
    .form-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
    }
    .btn-primary {
        background-color: #252c54;
        color: white;
        padding: 10px 18px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    .btn-secondary {
        background-color: #ccc;
        color: #000;
        padding: 10px 18px;
        border-radius: 4px;
        text-decoration: none;
    }
    strong {
        display: block;
        margin-top: 15px;
        margin-bottom: 5px;
    }
    .checkbox-list {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .checkbox-list {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .checkbox-list label {
        display: flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap; /* 🟢 evita que se corte la línea */
    }


    .checkbox-list input[type="checkbox"] {
        margin-right: 6px;
    }
</style>

<div class="form-container">
    <div class="logo">
        <img src="{% static 'fichas/logo.png' %}" alt="Logo Institucional">
    </div>

    <div class="step-indicator">
        <div class="step" data-label="Preingreso"></div>
        <div class="step" data-label="Individualización y Denuncia"></div>
        <div class="step active" data-label="Motivo + Psicológico + Redes"></div>
        <div class="step" data-label="Plan de Acción"></div>
        <div class="step" data-label="Intervenciones"></div>
        <div class="step" data-label="Egreso"></div>
    </div>

    <form method="post">
        {% csrf_token %}

        <!-- MOTIVO INGRESO -->
        <div class="form-section">
            <h3>IV. Motivo de Ingreso</h3>
            {{ form_motivo.motivo_ingreso.label_tag }} {{ form_motivo.motivo_ingreso }}
            {{ form_motivo.descripcion_motivo.label_tag }} {{ form_motivo.descripcion_motivo }}
        </div>

        <!-- ASPECTOS PSICOLÓGICOS -->
        <div class="form-section">
            <h3>V. Afectación ámbito psicológico</h3>


            <table style="width: 100%; border: 1px solid black; border-collapse: collapse;">

                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Estado de conciencia:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">{{ form_psico.estado_conciencia }}</td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Grado de orientación global:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">{{ form_psico.orientacion }}</td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Estado cognitivo global:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.estado_cognitivo %}
                                <label>{{ checkbox }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Actitud:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.actitud %}
                                <label>{{ checkbox.tag }} {{ checkbox.choice_label }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Lenguaje:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.lenguaje %}
                                <label>{{ checkbox.tag }} {{ checkbox.choice_label }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Afectividad emocional:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.afectividad %}
                                <label>{{ checkbox.tag }} {{ checkbox.choice_label }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Sueño:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.sueno %}
                                <label>{{ checkbox.tag }} {{ checkbox.choice_label }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Actitud/conducta alimentaria:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.alimentacion %}
                                <label>{{ checkbox.tag }} {{ checkbox.choice_label }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Limitación en su vida cotidiana:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">
                        <div class="checkbox-list">
                            {% for checkbox in form_psico.limitacion_vida_cotidiana %}
                                <label>{{ checkbox.tag }} {{ checkbox.choice_label }}</label>
                            {% endfor %}
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="border: 1px solid black; padding: 8px;"><strong>Existe un quiebre en su historia de vida por evento:</strong></td>
                    <td style="border: 1px solid black; padding: 8px;">{{ form_psico.quiebre_historia_vida }}</td>
                </tr>
            </table>
        </div>

        


        <!-- REDES DE APOYO -->
        <div class="form-section">
            <h3>VI. Redes de Apoyo</h3>

            <strong>Redes Personales</strong>
            {{ form_redes.red_familiares.label_tag }} {{ form_redes.red_familiares }}
            {{ form_redes.red_amistades.label_tag }} {{ form_redes.red_amistades }}
            {{ form_redes.red_conyuge.label_tag }} {{ form_redes.red_conyuge }}
            {{ form_redes.red_laborales.label_tag }} {{ form_redes.red_laborales }}
            {{ form_redes.red_otros_personales.label_tag }} {{ form_redes.red_otros_personales }}

            <strong>Redes Comunitarias</strong>
            {{ form_redes.red_junta_vecinos.label_tag }} {{ form_redes.red_junta_vecinos }}
            {{ form_redes.red_centro_madres.label_tag }} {{ form_redes.red_centro_madres }}
            {{ form_redes.red_club_adultos.label_tag }} {{ form_redes.red_club_adultos }}
            {{ form_redes.red_club_deportivo.label_tag }} {{ form_redes.red_club_deportivo }}
            {{ form_redes.red_otros_comunitarios.label_tag }} {{ form_redes.red_otros_comunitarios }}

            <strong>Redes Institucionales</strong>
            {{ form_redes.red_municipalidad.label_tag }} {{ form_redes.red_municipalidad }}
            {{ form_redes.red_cesfam.label_tag }} {{ form_redes.red_cesfam }}
            {{ form_redes.red_cosam.label_tag }} {{ form_redes.red_cosam }}
            {{ form_redes.red_otro_salud.label_tag }} {{ form_redes.red_otro_salud }}
            {{ form_redes.red_establecimiento.label_tag }} {{ form_redes.red_establecimiento }}
            {{ form_redes.red_ong.label_tag }} {{ form_redes.red_ong }}
        </div>

        <!-- BOTONES -->
        <div class="form-buttons">
            <a href="{% url 'fichas:crear_ficha_paso_2' ficha.id %}" class="btn-secondary">← Atrás</a>
            <button type="submit" class="btn-primary">Guardar y continuar →</button>
        </div>
    </form>
</div>
{% endblock %}
